# MySQL

### What is MySQL?

- DBMS (Database management system):
    - executes instructions on how to process data
    - relational db:
        - tables, that are linked by relations
        - uses SQL (Structured Query Language)
    - nonrelational / no SQL:
        - no tables
        - don’t understand SQL

### Commands:

- `**SELECT**`
    
    ```bash
    **SELECT** *
    **FROM** table
    **WHERE** column_name_id = ##
    **ORDER BY** column_name2
    LIMIT #
    ```
    
    —> * = select all
    
    —> FROM, WHERE, ORDER BY are optional
    
    —> need to be in correct oder
    
    ```sql
    **SELECT** 
    	first_column, 
    	second_column, ...
    
    --------------------
    
    **SELECT** first_column **AS** "new_name"
    
    --------------------
    
    **SELECT DISTINCT** column_name
    ```
    
    —> order of columns can be varied
    
    —> **AS** can rename columns
    
    —> **SELECT DISTINCT** doesn’t show duplicates
    
    ```sql
    **SELECT** first_column + 10
    ```
    
    —> arithmetic also possible (+, -, *, /, %)
    
    —> *, / have higher precedence (need to use parenthesis) 
    
- comment out
    
    `-- some command`
    
- `**WHERE**`
    - works with conditions (>, ≥, <, ≤ (<=) , =, ≠ (!=, <>))
    
    ```sql
    **WHERE** entry > 3000
    -------------------
    **WHERE** entry = "something"
    ```
    
- `**AND, OR, NOT**`
    
    ```sql
    1. **WHERE** column_name >= "some condition" **AND** column_name >= "some condition" 
    2. **WHERE** column_name >= "some condition" **OR** column_name >= "some condition" 
    2. **WHERE NOT**(column_name >= "some condition")
    ```
    
    1. only records shown, that satisfy both conditions
    2. only records shown, that satisfy either condition
        - combining operators:
            - **AND** is always evaluated first
            - can use parenthesis
    3. only shows records, that don’t satisfy condition
        1. (**NOT** >) = <=
        2. **NOT** (… **OR** … ) = … **AND** …
        
- **`IN, BETWEEN`**
    
    ```sql
    1. **WHERE** column_name **IN** ("A", "B", "C")
    2. **WHERE** column_name **NOT IN** ("A", "B", "C")
    ```
    
    1. only shows records with entry in A, B, or C
    2. only shows records with entry not in A, B, or C
    
    ```sql
    1. **WHERE** column_name **BETWEEN** 1000 **AND** 3000
    ```
    
- **`LIKE, REGEXP`**
    
    ### LIKE
    
    ```sql
    1. **WHERE** column_name **LIKE** "b%"
    ```
    
    1. only shows records that start with  b in that column
        - “b%” means any amount of characters that can appear after b (”%b%”, “%y”)
        - “_b” means records only have two characters and end with b ( _ stands for one character, “_ _ _ _ b” = 5 characters, end with b)
    
    ### REGEXP = Regular expression
    
    ```sql
    1. WHERE column_name REGEXP "something"
    2. WHERE column_name REGEXP "^something"
    3. WHERE column_name REGEXP "something$"
    4. WHERE column_name REGEXP "A|B"
    5. WHERE column_name REGEXP "[gim]e"
    6. WHERE column_name REGEXP "[a-h]e"
    ```
    
    1. only shows records that contain “something” in their entry
    2. only shows records that begin with “something”
    3. only shows records that end with “something”
    4. only shows records that contain “A” or “B”
    5. only shows records that contain “ge” or “ie” or “me”
    6. only shows records that contain a letter from a to h before an e
- `**IS NULL**`
    
    ```sql
    1. **WHERE** column_number **IS NULL 
    2. WHERE** column_number **IS NOT NULL**
    ```
    
    1. only shows records with null entries
    2. only shows records with not null entries
- `**ORDER BY**`
    - click on settings icon on table —> entries will be sorted by column showing primary key symbol
    
    ```sql
    1. ORDER BY column_name
    2. ORDER BY column_name DESC
    3. ORDER BY column1, column2
    4. SELECT column1, column2, 10 AS column4
    	 FROM ...
       ORDER BY column3, column4
    ```
    
    1. entries sorted by ascending order
    2. entries sorted by descending order
    3. entries first order by column1 in ascending order and rows with the same entry in column1 are then sorted by column2 in ascending order
    4. can also sort by columns not selected or by the alias
    
- `**LIMIT**`
    
    ```sql
    1. LIMIT 3
    2. LIMIT 6, 3
    ```
    
    1. only shows first 3 entries
    2. offset: only shows three entries after entry 6
    

### Joins and Unions

- Inner Joins
    
    ```sql
    **SELECT** *
    **FROM** table1
    **JOIN** column_name **ON** table1.id = table2.id 
    ```
    
    - joins entries from table1 to entries from table2 based on a given ID (columns named id)
    - example:
        
        ```sql
        **SELECT** *
        **FROM** orders
        **JOIN** customers **ON** orders.customer_id = customers.customer_id
        ```
        
        adds order to the customer information based on customer ID
        
    - if column that shows up in both tables is selected, than it needs to be specified:
        
        ```sql
        **SELECT** order_id, orders.customer_id, name
        **FROM** orders
        **JOIN** customers **ON** orders.customer_id = customers.customer.id
        ```
        
        - can be simplified by alias:
            
            ```sql
            **SELECT** order_id, o.customer_id, name
            **FROM** orders c
            **JOIN** customers c **ON** o.customer_id = c.customer.id
            ```
            
    - can also join multiple tables by using **JOIN** multiple time
    - can also join based on multiple conditions with **AND**
- Joining across databases
    - need to specify database where table that is used is located, e.g. `**FROM** database.table`
- Self Joins
    
    ```sql
    **SELECT** *
    **FROM** table1 t
    **JOIN** table1 ta **ON** t.column1 = ta.column2
    ```
    
    example: a list of all employees and who their manager is
    
    ```sql
    SELECT 
    	e.employee_id,
    	e.first_name
    	m.first_name AS manager
    FROM employees e
    JOIN employees m 
    	ON e.reports_to = m.employee_id
    ```
    
- Outer Joins
    - inner join: only shows results where condition is matched
    - outer join:
        - `**LEFT JOIN`** all entries from left table are shown with matches from right table
        - `**RIGHT JOIN`** all entries from right table are shown with matches from left table
        - can also be used in self join
- `**USING**`
    - can replace `**ON`** clause in `**JOIN`** or **`OUTER JOIN`**
        - only works when both tables use same column name
    
    ```sql
    **SELECT** *
    **FROM** table1 t1
    **JOIN** table2 t2
    	**USING** (column_name)
    ```
    
    - can also be used for multiple conditions:
    
    ```sql
    **SELECT** *
    **FROM** table1 t1
    **JOIN** table2 **USING** (column_name1, column_name2)
    ```
    
- Cross Joins
    - `**CROSS JOIN`** or **`FROM** table1, table2`
    - used to combine every record from first table with every record from second table
    
- `**UNION**`
    - combines records from multiple queries (combines their rows)
        - only works when amount of selected columns from first and second table are the same
    
    ```sql
    **SELECT** column1
    **FROM** table1
    **UNION**
    **SELECT** column1
    **FROM** table2
    ```
    

### Inserting, Updating and Deleting Columns

- column attributes
    
    ![Untitled](MySQL%208cdffbb8322a45698fd23b514d775347/Untitled.png)
    
    PK: primary key (little key item left)
    
    NN: not null (specifies if column can be left blank or not)
    
    AI: auto increment (automatically add number (incremented) to a new row)
    
- inserting row or rows
    
    example:
    
    ```sql
    **INSERT INTO** table1
    **VALUES** (
    	**DEFAULT**, 
    	"JOHN", 
    	"SMITH", 
    	**NULL**, 
    	**NULL**, 
    	"address", 
    	"city", 
    	"state", 
    	**DEFAULT**)
    ```
    
    - `**DEFAULT`** used for AI columns
    - `**NULL**` used for columns NN not selected (Default value for when null, that is set in column attributes)
    
    example without `**NULL`**  or `**DEFAULT**`
    
    ```sql
    **INSERT INTO** table1 (
    	first_name,
    	last_name,
    	birth_date, 
    	address,
    	city, 
    	state)
    **VALUES** (
    	"JOHN", 
    	"SMITH", 
    	"address", 
    	"city", 
    	"state")
    ```
    
    - can also de-order the columns
    
    - inserting multiple rows:
        
        ```sql
        INSERT INTO table2 (name)
        VALUE ("value1"),
        			("value2"),
        			("value3")
        ```
        
    - inserting hierarchical rows, example:
        
        ```sql
        INSERT INTO orders (customer_id, order_date, status)
        VALUE (1, "2019-01-02", 1)
        
        INSERT INTO order_items
        VALUES 
        		(LAST_INSERT_ID(), 1, 1, 2.95)
        		(LAST_INSERT_ID(), 1, 1, 2.95)
        ```
        
        - `LAST_INSERT_ID()` MySQL function to return lastly inserted function